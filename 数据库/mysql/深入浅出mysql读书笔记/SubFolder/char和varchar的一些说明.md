# 结论

Mysql 5中

非空CHAR的最大总长度是255【字节】；非空VARCHAR的最大总长度是65533【字节】。

可空CHAR的最大总长度是254【字节】；可空VARCHAR的最大总长度是65532【字节】。

原因：非空标记需要占据一个字节，VARCHAR超过255需要用2个字节标记字段长度，不超过255用1个字节标记字段长度.

注意上边是 【字节】，不是【字符】。但mysql5字段定义时，是定义的【字符】数。比如varchar(10)，你仅能存入10个英文字母或者汉字，尽管一个字符可能占多个字节。一个字符可能占用多个字节，这由编码和存放的字符决定。比如UTF8（一种变长的unicode编码）中，一般一个汉字占据3个字节，一个英文字母占据一个字节。

所以，在UTF8的环境下，不允许定义 VARCHAR(65535)，因为这远远超出了65535个字节的限制。  

#  以下是MYSQL 官网上的说明

CHAR和VARCHAR类型类似，但它们保存和检索的方式不同。它们的最大长度和是否尾部空格被保留等方面也不同。

CHAR和VARCHAR类型声明的长度表示你想要保存的最大字符数。例如，CHAR(30)可以占用30个字符。

CHAR列的长度固定为创建表时声明的长度。长度可以为从0到255的任何值。当保存CHAR值时，**在它们的右边填充空格以达到指定的长度。当检索到CHAR值时，尾部的空格被删除掉。**

VARCHAR列中的值为可变长字符串。长度可以指定为0到65,535之间的值。VARCHAR的最大有效长度由最大行大小（65,535字节）和使用的字符集确定。同CHAR对比，VARCHAR值保存时只保存字符，另加一个字节来记录长度(如果列声明的长度超过255，则使用两个字节)。**VARCHAR值保存时不进行填充。当值保存和检索时尾部的空格仍保留，符合标准SQL。**

总结如下：

| 特性         | `CHAR`                                                       | `VARCHAR`                                                    |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 长度         | 定长，固定字符数 最大255个字符 数据长度不足声明值时，在尾部自动填充空格 | 长度可变，可设置最大存储字符数 最大不超过行大小（默认65535**字节**，注意是字节，下面会讲原因） |
| 前缀         | 无                                                           | 1~2字节，看列长度是否可能超过255字节 比如`VARCHAR(100)`，字符集为`UTF8`，则字节最大可能为300字节，所以会使用2个字节标识长度 |
| 有否尾部空格 | 长度不足默认用空格填满 检索和获取时会自动去除                | 不会自动填充空格，如输入值就包含空格，则会存储，检索和获取数据都会体现 |
| 超长处理     | 超长部分如果是空格自动截断，不生成警告 如果是字符，严格模式下会报错，非严格模式则生成警告 | 超长部分如果是空格自动截断，并生成警告 如果是字符，严格模式下会报错，非严格模式则生成警告 |
| 存储开销     | 数据值的字节和 + 补位空格数                                  | 数据值的字节和 + 长度标识字节数                              |



下面的表显示了将各种字符串值保存到CHAR(4)和VARCHAR(4)列后的结果，说明了CHAR和VARCHAR之间的差别：  

| 值           | `CHAR(4)` | 需要存储 | `VARCHAR(4)` | 需要存储 |
| ------------ | --------- | -------- | ------------ | -------- |
| `''`         | `'    '`  | 4字节    | `''`         | 1个字节  |
| `'ab'`       | `'ab  '`  | 4字节    | `'ab'`       | 3个字节  |
| `'abcd'`     | `'abcd'`  | 4字节    | `'abcd'`     | 5字节    |
| `'abcdefgh'` | `'abcd'`  | 4字节    | `'abcd'`     | 5字节    |

显示在表最后一行中的值*仅在不使用严格模式时*适用 ；如果MySQL在严格模式下运行，则不会存储超过列长度的值，并会报错。





# 参考

- mysql文档：https://dev.mysql.com/doc/refman/5.7/en/char.html
- 这篇博客的前半部分：https://www.cnblogs.com/zhuyeshen/p/10972246.html
- 大佬详解：https://learn.blog.csdn.net/article/details/103341778#commentBox